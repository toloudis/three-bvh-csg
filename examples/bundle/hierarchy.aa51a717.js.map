{"mappings":"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","sources":["examples/hierarchy.js"],"sourcesContent":["import * as THREE from 'three';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport {\n\tEvaluator,\n\tOperation,\n\tOperationGroup,\n\tGridMaterial,\n\tADDITION,\n\tSUBTRACTION,\n} from '..';\n\nconst params = {\n\n\tsnap: true,\n\twireframe: false,\n\tdisplayControls: true,\n\ttransparentBrushes: true,\n\tdisplay: 'OVERLAY',\n\n};\n\nlet renderer, camera, scene, gui, outputContainer;\nlet controls, transformControls;\nlet light;\nlet csgEvaluator;\n\nlet result, root, brushMat, resultGridMat, wireframeObject;\n\ninit();\n\nasync function init() {\n\n\tconst bgColor = 0x111111;\n\n\toutputContainer = document.getElementById( 'output' );\n\n\t// renderer setup\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( bgColor, 1 );\n\tdocument.body.appendChild( renderer.domElement );\n\n\t// scene setup\n\tscene = new THREE.Scene();\n\n\t// lights\n\tlight = new THREE.DirectionalLight( 0xffffff, 1 );\n\tlight.position.set( - 1, 2, 3 );\n\tscene.add( light, light.target );\n\tscene.add( new THREE.AmbientLight( 0xb0bec5, 0.1 ) );\n\n\t// camera setup\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 50 );\n\tcamera.position.set( 3, 2, 4 ).multiplyScalar( 2 );\n\tcamera.far = 100;\n\tcamera.updateProjectionMatrix();\n\n\t// controls\n\tcontrols = new OrbitControls( camera, renderer.domElement );\n\n\ttransformControls = new TransformControls( camera, renderer.domElement );\n\ttransformControls.setSize( 0.75 );\n\ttransformControls.addEventListener( 'dragging-changed', e => {\n\n\t\tcontrols.enabled = ! e.value;\n\n\t} );\n\ttransformControls.addEventListener( 'objectChange', e => {\n\n\t\tif ( params.snap ) {\n\n\t\t\tconst o = transformControls.object;\n\t\t\to.position.x = Math.floor( o.position.x * 1e1 ) * 1e-1;\n\t\t\to.position.y = Math.floor( o.position.y * 1e1 ) * 1e-1;\n\t\t\to.position.z = Math.floor( o.position.z * 1e1 ) * 1e-1;\n\n\t\t}\n\n\t} );\n\tscene.add( transformControls );\n\n\t// bunny mesh has no UVs so skip that attribute\n\tcsgEvaluator = new Evaluator();\n\tcsgEvaluator.attributes = [ 'position', 'normal' ];\n\tcsgEvaluator.useGroups = false;\n\n\tbrushMat = new GridMaterial();\n\tbrushMat.side = THREE.DoubleSide;\n\tbrushMat.polygonOffset = true;\n\tbrushMat.polygonOffsetFactor = 2;\n\tbrushMat.polygonOffsetUnits = 1;\n\tbrushMat.opacity = 0.15;\n\tbrushMat.transparent = true;\n\tbrushMat.depthWrite = false;\n\tbrushMat.color.set( 0xffc400 );\n\n\tresultGridMat = brushMat.clone();\n\tresultGridMat.opacity = 1;\n\tresultGridMat.transparent = false;\n\tresultGridMat.depthWrite = true;\n\tresultGridMat.polygonOffsetFactor = 1;\n\tresultGridMat.polygonOffsetUnits = 1;\n\tresultGridMat.color.set( 0xffffff );\n\n\twireframeObject = new THREE.Mesh( undefined, new THREE.MeshBasicMaterial( { color: 0, wireframe: true } ) );\n\twireframeObject.material.color.set( 0xffc400 ).multiplyScalar( 0.1 );\n\tscene.add( wireframeObject );\n\n\troot = new Operation( new THREE.BoxBufferGeometry( 10, 5, 5 ), brushMat );\n\tscene.add( root );\n\n\t{\n\n\t\tconst inside = new Operation( new THREE.BoxBufferGeometry( 9, 4.5, 4 ), brushMat );\n\t\tinside.operation = SUBTRACTION;\n\t\troot.add( inside );\n\n\t}\n\n\t{\n\n\t\tconst hole = new Operation( new THREE.CylinderBufferGeometry( 0.5, 0.5, 1, 20 ), brushMat );\n\t\thole.operation = SUBTRACTION;\n\t\thole.rotateX( Math.PI / 2 );\n\t\thole.position.y = 0.25;\n\n\t\tconst hole2 = new Operation( new THREE.BoxBufferGeometry( 1, 2.5, 1 ), brushMat );\n\t\thole2.operation = SUBTRACTION;\n\t\thole2.position.y = - 1;\n\n\t\tconst doorGroup = new OperationGroup();\n\t\tdoorGroup.position.z = 2.2;\n\t\tdoorGroup.add( hole, hole2 );\n\t\troot.add( doorGroup );\n\t\ttransformControls.attach( doorGroup );\n\n\t}\n\n\t{\n\n\t\tconst hole = new Operation( new THREE.BoxBufferGeometry( 2, 1.75, 2 ), brushMat );\n\t\thole.operation = SUBTRACTION;\n\n\t\tconst frame = new Operation( new THREE.BoxBufferGeometry( 2, 1.75, 0.2 ), brushMat );\n\t\tframe.operation = ADDITION;\n\n\t\tconst hole2 = new Operation( new THREE.BoxBufferGeometry( 1.9, 1.65, 2 ), brushMat );\n\t\thole2.operation = SUBTRACTION;\n\n\t\tconst bar1 = new Operation( new THREE.BoxBufferGeometry( 2, 0.1, 0.1 ), brushMat );\n\t\tbar1.operation = ADDITION;\n\n\t\tconst bar2 = new Operation( new THREE.BoxBufferGeometry( 0.1, 2, 0.1 ), brushMat );\n\t\tbar2.operation = ADDITION;\n\n\t\tconst windowGroup = new OperationGroup();\n\t\twindowGroup.add( hole, frame, hole2, bar1, bar2 );\n\t\twindowGroup.position.x = - 3;\n\t\twindowGroup.position.z = 2.2;\n\t\troot.add( windowGroup );\n\n\t}\n\n\t{\n\n\t\tconst hole = new Operation( new THREE.BoxBufferGeometry( 2, 1.75, 2 ), brushMat );\n\t\thole.operation = SUBTRACTION;\n\n\t\tconst frame = new Operation( new THREE.BoxBufferGeometry( 2, 1.75, 0.2 ), brushMat );\n\t\tframe.operation = ADDITION;\n\n\t\tconst hole2 = new Operation( new THREE.BoxBufferGeometry( 1.9, 1.65, 2 ), brushMat );\n\t\thole2.operation = SUBTRACTION;\n\n\t\tconst bar1 = new Operation( new THREE.BoxBufferGeometry( 2, 0.1, 0.1 ), brushMat );\n\t\tbar1.operation = ADDITION;\n\n\t\tconst bar2 = new Operation( new THREE.BoxBufferGeometry( 0.1, 2, 0.1 ), brushMat );\n\t\tbar2.operation = ADDITION;\n\n\t\tconst windowGroup = new OperationGroup();\n\t\twindowGroup.add( hole, frame, hole2, bar1, bar2 );\n\t\twindowGroup.position.x = 3;\n\t\twindowGroup.position.z = 2.2;\n\t\troot.add( windowGroup );\n\n\t}\n\n\t// gui\n\tgui = new GUI();\n\tgui.add( params, 'wireframe' );\n\tgui.add( params, 'snap' );\n\tgui.add( params, 'displayControls' );\n\tgui.add( params, 'transparentBrushes' );\n\tgui.add( params, 'display', [ 'OVERLAY', 'BRUSHES', 'RESULT' ] );\n\n\twindow.addEventListener( 'resize', function () {\n\n\t\tcamera.aspect = window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\n\t}, false );\n\n\twindow.addEventListener( 'keydown', function ( e ) {\n\n\t\tswitch ( e.code ) {\n\n\t\t\tcase 'KeyW':\n\t\t\t\ttransformControls.setMode( 'translate' );\n\t\t\t\tbreak;\n\t\t\tcase 'KeyE':\n\t\t\t\ttransformControls.setMode( 'rotate' );\n\t\t\t\tbreak;\n\t\t\tcase 'KeyR':\n\t\t\t\ttransformControls.setMode( 'scale' );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t} );\n\n\trender();\n\n}\n\nfunction render() {\n\n\trequestAnimationFrame( render );\n\n\tconst startTime = window.performance.now();\n\n\tif ( params.transparentBrushes ) {\n\n\t\tbrushMat.depthWrite = false;\n\t\tbrushMat.transparent = true;\n\t\tbrushMat.opacity = 0.15;\n\n\t} else {\n\n\t\tbrushMat.depthWrite = true;\n\t\tbrushMat.transparent = false;\n\t\tbrushMat.opacity = 1;\n\n\t}\n\n\tif ( result ) {\n\n\t\tresult.geometry.dispose();\n\t\tresult.parent.remove( result );\n\n\t}\n\n\tresult = csgEvaluator.evaluateHierarchy( root );\n\tresult.material = resultGridMat;\n\tscene.add( result );\n\n\twireframeObject.geometry = result.geometry;\n\twireframeObject.visible = params.wireframe;\n\n\tconst deltaTime = window.performance.now() - startTime;\n\toutputContainer.innerText = `${ deltaTime.toFixed( 3 ) }ms`;\n\n\ttransformControls.enabled = params.displayControls;\n\ttransformControls.visible = params.displayControls;\n\n\tresult.visible = params.display !== 'BRUSHES';\n\troot.visible = params.display !== 'RESULT';\n\n\trenderer.render( scene, camera );\n\n}\n\n\n\n"],"names":["$ilwiq","parcelRequire","$7cdee9df2c38e2c6$var$params","snap","wireframe","displayControls","transparentBrushes","display","$7cdee9df2c38e2c6$var$renderer","$7cdee9df2c38e2c6$var$camera","$7cdee9df2c38e2c6$var$scene","$7cdee9df2c38e2c6$var$gui","$7cdee9df2c38e2c6$var$outputContainer","$7cdee9df2c38e2c6$var$controls","$7cdee9df2c38e2c6$var$transformControls","$7cdee9df2c38e2c6$var$light","$7cdee9df2c38e2c6$var$csgEvaluator","$7cdee9df2c38e2c6$var$result","$7cdee9df2c38e2c6$var$root","$7cdee9df2c38e2c6$var$brushMat","$7cdee9df2c38e2c6$var$resultGridMat","$7cdee9df2c38e2c6$var$wireframeObject","$7cdee9df2c38e2c6$var$render","requestAnimationFrame","startTime","window","performance","now","depthWrite","transparent","opacity","geometry","dispose","parent","remove","evaluateHierarchy","material","add","visible","deltaTime","innerText","toFixed","enabled","render","async","document","getElementById","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","innerWidth","innerHeight","setClearColor","body","appendChild","domElement","Scene","DirectionalLight","position","set","target","AmbientLight","PerspectiveCamera","multiplyScalar","far","updateProjectionMatrix","$5Rd1x","OrbitControls","$fUhpq","TransformControls","addEventListener","e","value","o","object","x","Math","floor","y","z","$4CEV9","Evaluator","attributes","useGroups","GridMaterial","side","DoubleSide","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","color","clone","Mesh","undefined","MeshBasicMaterial","Operation","BoxBufferGeometry","inside","operation","SUBTRACTION","hole","CylinderBufferGeometry","rotateX","PI","hole2","doorGroup","OperationGroup","attach","frame","ADDITION","bar1","bar2","windowGroup","$jiuw3","GUI","aspect","code","setMode","$7cdee9df2c38e2c6$var$init"],"version":3,"file":"hierarchy.aa51a717.js.map"}